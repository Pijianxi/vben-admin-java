var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,o=("undefined"!=typeof require&&require,(e,t,a)=>new Promise(((r,l)=>{var o=e=>{try{s(a.next(e))}catch(t){l(t)}},n=e=>{try{s(a.throw(e))}catch(t){l(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,n);s((a=a.apply(e,t)).next())})));import{g as n,h as s}from"./useForm.63daa5ff.js";import{z as i,bp as d,D as u,r as c,j as m,u as p,a0 as f,F as h,a1 as b,a5 as g,w as v,a4 as y}from"./vendor.54f9b785.js";/* empty css              */import{s as w,j as x,n as j,o as k}from"./system.0924da72.js";import{i as D}from"./index.2e6c4439.js";import{B as I,a as S}from"./index.fd3f7918.js";import{_ as F}from"./Tree.vue_vue&type=style&index=0&lang.17a7d87d.js";const P=[{title:"角色名称",dataIndex:"roleName",width:200},{title:"角色值",dataIndex:"roleValue",width:180},{title:"排序",dataIndex:"orderNo",width:50},{title:"状态",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),i(d,{checked:1===e.status,checkedChildren:"已启用",unCheckedChildren:"已禁用",loading:e.pendingStatus,onChange(t){e.pendingStatus=!0;const a=t?1:0,{createMessage:r}=D();w(e.id,a).then((()=>{e.status=a,r.success("已成功修改角色状态")})).catch((()=>{r.error("修改角色状态失败")})).finally((()=>{e.pendingStatus=!1}))}}))},{title:"创建时间",dataIndex:"createTime",width:180},{title:"备注",dataIndex:"remark"}],B=[{field:"roleNme",label:"角色名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"停用",value:0}]},colProps:{span:8}}],O=[{field:"roleName",label:"角色名称",required:!0,component:"Input"},{field:"roleValue",label:"角色值",required:!0,component:"Input"},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"停用",value:0}]}},{label:"备注",field:"remark",component:"InputTextArea"},{label:" ",field:"menu",slot:"menu",component:"Input"}];var R=u({name:"RoleDrawer",components:{BasicDrawer:I,BasicForm:n,BasicTree:F},emits:["success","register"],setup(e,{emit:n}){const i=c(!0),d=c([]),u=c(0),[f,{resetFields:h,setFieldsValue:b,validate:g}]=s({labelWidth:90,schemas:O,showActionButtonGroup:!1}),[v,{setDrawerProps:y,closeDrawer:w}]=S((e=>o(this,null,(function*(){yield h(),y({confirmLoading:!1}),0===p(d).length&&(d.value=yield x()),i.value=!!(null==e?void 0:e.isUpdate),p(i)&&(u.value=e.record.id,yield b(((e,o)=>{for(var n in o||(o={}))a.call(o,n)&&l(e,n,o[n]);if(t)for(var n of t(o))r.call(o,n)&&l(e,n,o[n]);return e})({},e.record)))}))));return{registerDrawer:v,registerForm:f,getTitle:m((()=>p(i)?"编辑角色":"新增角色")),handleSubmit:function(){return o(this,null,(function*(){try{const e=yield g();y({confirmLoading:!0}),e.menu.checked&&(e.menu=e.menu.checked);let t=e;if(p(i)){t.id=u.value,(yield j(t))&&(w(),n("success"))}else{(yield k(t))&&(w(),n("success"))}}finally{y({confirmLoading:!1})}}))},treeData:d}}});R.render=function(e,t,a,r,l,o){const n=f("BasicTree"),s=f("BasicForm"),i=f("BasicDrawer");return h(),b(i,y(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:g((()=>[v(s,{onRegister:e.registerForm},{menu:g((({model:t,field:a})=>[v(n,{value:t[a],"onUpdate:value":e=>t[a]=e,treeData:e.treeData,replaceFields:{title:"menuName",key:"id"},checkable:"",checkStrictly:!0,toolbar:!0,title:"菜单分配"},null,8,["value","onUpdate:value","treeData"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var _=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:R});export{_ as R,R as _,P as c,B as s};
