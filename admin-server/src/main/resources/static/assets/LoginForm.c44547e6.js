"undefined"!=typeof require&&require;var e,a=(e,a,t)=>new Promise(((s,o)=>{var n=e=>{try{r(t.next(e))}catch(a){o(a)}},l=e=>{try{r(t.throw(e))}catch(a){o(a)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,l);r((t=t.apply(e,a)).next())}));import{D as t,aY as s,aZ as o,a_ as n,aS as l,a$ as r,an as c,r as i,P as u,j as d,u as m,au as p,t as g,a0 as f,F as h,G as y,H as v,J as x,w,a5 as I,K as b,ad as C,L as _,b0 as L,aa as F}from"./vendor.54f9b785.js";/* empty css              *//* empty css              */import{_ as S,u as k,a as D,L as M,b as j}from"./LoginFormTitle.8e449bcf.js";import{f as P,d as R,c as T,h as z,i as B}from"./index.2e6c4439.js";(e||(e={})).getCaptcha="/captcha/getCaptcha";var U=t({name:"LoginForm",components:{[s.name]:s,[o.name]:o,Checkbox:n,Button:l,Form:r,FormItem:r.Item,Input:c,LoginFormTitle:S,InputPassword:c.Password},setup(){const{t:t}=R(),{notification:s,createErrorModal:o}=B(),{prefixCls:n}=T("login"),l=z(),{setLoginState:r,getLoginState:c}=k(),{getFormRules:f}=D(),h=i(),y=i(!1),v=i(!1),x=i(""),w=u({account:"",password:"",captchaId:"",captcha:""}),{validForm:I}=j(h),b=d((()=>m(c)===M.LOGIN));function C(){return a(this,null,(function*(){let a=yield function(a="modal"){return P.get({url:e.getCaptcha},{errorMessageMode:a})}();w.captchaId=a.captchaId,x.value=a.imgBase64}))}return p((()=>a(this,null,(function*(){yield C()})))),{t:t,prefixCls:n,formRef:h,formData:w,getFormRules:f,rememberMe:v,handleLogin:function(){return a(this,null,(function*(){const e=yield I();if(e)try{y.value=!0;(yield l.login(g({password:e.password,username:e.account,captcha:e.captcha,captchaId:w.captchaId,rememberMe:v.value,mode:"none"})))&&s.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${e.account}`,duration:3})}catch(a){o({title:t("sys.api.errorTip"),content:a.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{y.value=!1}}))},loading:y,setLoginState:r,LoginStateEnum:M,getShow:b,captchaImg:x,getCaptchaImg:C}}});const $=["src"];U.render=function(e,a,t,s,o,n){const l=f("LoginFormTitle"),r=f("Input"),c=f("FormItem"),i=f("InputPassword"),u=f("ACol"),d=f("ARow"),m=f("Checkbox"),p=f("Button"),g=f("Form");return h(),y(F,null,[v(w(l,{class:"enter-x"},null,512),[[x,e.getShow]]),v(w(g,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef",onKeypress:L(e.handleLogin,["enter"])},{default:I((()=>[w(c,{name:"account",class:"enter-x"},{default:I((()=>[w(r,{size:"large",value:e.formData.account,"onUpdate:value":a[0]||(a[0]=a=>e.formData.account=a),placeholder:e.t("sys.login.userName")},null,8,["value","placeholder"])])),_:1}),w(c,{name:"password",class:"enter-x"},{default:I((()=>[w(i,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":a[1]||(a[1]=a=>e.formData.password=a),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),w(c,{name:"captcha"},{default:I((()=>[w(d,{class:"enter-x"},{default:I((()=>[w(u,{span:18},{default:I((()=>[w(r,{value:e.formData.captcha,"onUpdate:value":a[2]||(a[2]=a=>e.formData.captcha=a),size:"large",placeholder:e.t("sys.login.captcha")},null,8,["value","placeholder"])])),_:1}),w(u,{span:5,style:{"margin-left":"10px"}},{default:I((()=>[b("img",{src:e.captchaImg,alt:"",onClick:a[3]||(a[3]=(...a)=>e.getCaptchaImg&&e.getCaptchaImg(...a))},null,8,$)])),_:1})])),_:1})])),_:1}),w(d,{class:"enter-x"},{default:I((()=>[w(u,{span:12},{default:I((()=>[w(c,null,{default:I((()=>[w(m,{checked:e.rememberMe,"onUpdate:checked":a[4]||(a[4]=a=>e.rememberMe=a),size:"small"},{default:I((()=>[C(_(e.t("sys.login.rememberMe")),1)])),_:1},8,["checked"])])),_:1})])),_:1})])),_:1}),w(c,{class:"enter-x"},{default:I((()=>[w(p,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:I((()=>[C(_(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules","onKeypress"]),[[x,e.getShow]])],64)};export{U as default};
